#include "P16F84a.INC" 
CONTADOR EQU 0x20
CONTADOR2 EQU 0X21
TEMP EQU 0X22
TEMP2 EQU 0X23
POS_PANT EQU 0X24
REGISTROS EQU 0X25
RETARDO	EQU 0X26
BSF STATUS,RP0	;IR AL BANCO 1
CLRF TRISB		;PUERTO DE COMANDOS Y DATOS
CLRF TRISA 		;PUERTO B Y A SEAN SALIDAS
BSF TRISA,3		;RA3 ENTRADA
BCF STATUS,RP0	;CERRAR PUERTO IR AL BANCO 0
;BIT 0 DE PORTA ES MODO
;CODIGO  OBLIGATORIO *************************************
CALL MODO_COMANDO
MOVLW B'00110000'	;DL=BUS DE 8 Ó 4 BITS (USAMOS EL DE 8)
MOVWF PORTB			;N=NUMERO DE LINEAS
CALL PULSO35		;F=TAMAÑO DE CARACTERES
MOVLW B'00001101';DISPLAY_CONTROL
				;|0|0|0|0|1|D|C|B|
 				;D=PANTALLA ACTIVA
MOVWF PORTB 	;C=CURSOR ACTIVADO
CALL PULSO35 	;B=PARPADEA CURSOR
				;MODO_SET
MOVLW B'00000110'	;|0|0|0|0|0|1|I\D|S
MOVWF PORTB		;I\D=INCREMENTA CURSOR
CALL PULSO35	;S=DESPLAZAMIENTO DE VISUALIZACION
MOVLW 0X83		;DDRAM ADRESS	 			
MOVWF PORTB		;"ADRESS"	
CALL PULSO35
CALL MODO_DATO  ;CODIGO  OBLIGATORIO **********************
;**************************** PRINCIPAL
INICIO:
NOP
MOVLW '#'
CALL IMPRIME  ;IMPRESION
MOVLW 'S'
CALL IMPRIME  ;IMPRESION
MOVLW 'V'
CALL IMPRIME  ;IMPRESION
MOVLW 'E'
CALL IMPRIME  ;IMPRESION
MOVLW 'A'
CALL IMPRIME  ;IMPRESION
MOVLW '#'
CALL IMPRIME  ;IMPRESION
MOVLW 0xE0	  ;VER EL MANUAL
CALL IMPRIME  ;IMPRESION
MOVLW '.'
CALL IMPRIME  ;IMPRESION
CALL TOPE
CALL BORRAR
CALL TOPE
MOVLW 0xE0	  ;VER EL MANUAL
CALL IMPRIME  ;IMPRESION
MOVLW '2'
CALL IMPRIME
MOVLW '1'
CALL IMPRIME
CALL FIN
;******************************************************
MODO_COMANDO ;function_set ;"|0|0|1|dl|n|f|x|x|"
BCF PORTA,0
CALL PULSO35
RETURN

MODO_DATO
BSF PORTA,0	;BIT RS DEL LCD
CALL PULSO35
RETURN

IMPRIME
MOVWF PORTB
CALL PULSO35
RETURN

BORRAR	
MOVLW 0X01		 ;BORRAR
MOVWF PORTB
CALL MODO_COMANDO
MOVLW 0X83		;DDRAM ADRESS	 			
MOVWF PORTB		;"ADRESS"
CALL PULSO35
CALL MODO_DATO
RETURN

PULSO35
BSF PORTA,1 ;BIT DE E DE LA LCD =1
MOVLW 0XB	;CARGAR A W CON 11
MOVWF RETARDO ;MOVER A RETARDO
LOOP
DECFSZ RETARDO,F
GOTO LOOP
BCF PORTA,1 ;BIT DE E DE LA LCD =0
RETURN

TOPE
BTFSC PORTA,3
GOTO TOPE
TOPEH
BTFSC PORTA,3
GOTO TOPEH
RETURN

FIN
NOP 
GOTO FIN

END